# UAT Report: OPS-001 and OPS-004 (2026-02-09)

## 1) Basic Info

| Field | Value |
| --- | --- |
| Project | `StockTracker` |
| Scope | `OPS-001 scheduler observability`, `OPS-004 rollback drill automation` |
| Environment | `Local (Windows)` |
| Tester | `edwar + Codex` |
| Test Date | `2026-02-09` |

## 2) In Scope

- Scheduler heartbeat and cycle reports.
- Scheduler run-once execution behavior.
- Rollback drill execution, archive retention.
- Release gate smoke after ops changes.

## 3) Test Cases

| Case ID | Scenario | Steps | Expected | Actual | Status | Evidence |
| --- | --- | --- | --- | --- | --- | --- |
| `OPS1-UAT-01` | Scheduler run-once executes configured job | Set env vars (`INGESTION_JOBS_PATH`, `SCHEDULER_*`), run `python backend/run_scheduler.py` with `SCHEDULER_RUN_ONCE=true` | One cycle runs then exits | Scheduler output: `Ingestion scheduler started`, `AAPL US 1d ingested=2`; process exits successfully | `PASS` | `.runtime/uat/ingestion_jobs_uat.json` |
| `OPS1-UAT-02` | Scheduler writes heartbeat | Read `.runtime/uat/scheduler_heartbeat.json` | Heartbeat exists with status/timestamp/report pointer | `status=ok`, `jobs_executed=1`, `symbols_failed=0` | `PASS` | `.runtime/uat/scheduler_heartbeat.json` |
| `OPS1-UAT-03` | Scheduler writes cycle report | Read latest `.runtime/uat/scheduler_reports/cycle_*.json` | Report exists with per-job summary | `jobs_executed=1`, `symbols_attempted=1`, `symbols_succeeded=1` | `PASS` | `.runtime/uat/scheduler_reports/cycle_20260209T103316Z.json` |
| `OPS4-UAT-01` | Rollback drill runs successfully | Run `python backend/scripts/rollback_drill.py --env staging --retain-count 2` | Drill exits `0`, summary + deploy report generated | Passed, summary/deploy reports created | `PASS` | `.runtime/rollback_drills/rollback_drill_summary_staging_20260209T103430Z.json` |
| `OPS4-UAT-02` | Rollback drill retention policy enforced | List `.runtime/rollback_drills` after `retain-count=2` | Keep latest 2 `deploy_report_*` + latest 2 `rollback_drill_summary_*` | Directory contains exactly 4 files (2 deploy + 2 summary) | `PASS` | `.runtime/rollback_drills/` |
| `OPSX-UAT-01` | Regression smoke after ops changes | Run `python -m pytest backend/tests -q` | All backend tests pass | `50 passed` | `PASS` | pytest output |
| `OPSX-UAT-02` | Release gate dev profile still passes | Run `python backend/scripts/release_gate.py --profile dev --skip-docker --allow-dirty-git` | Gate passes, report generated | `passed=True`, report generated | `PASS` | `.runtime/release_gate_dev_20260209T103515Z.json` |

## 4) Defects Found in This UAT

| Defect ID | Severity | Summary | Status |
| --- | --- | --- | --- |
| `OPS-BUG-001` | `P2` | `rollback_drill.py` retention applied before writing summary, causing summary files to exceed retention by +1 | `Closed (fixed + test added)` |

## 5) Final Decision

| Decision | Value |
| --- | --- |
| Go / No-Go | `Go` |
| Residual Risk | `Cloud endpoint integration (OPS-003) is intentionally deferred` |
| Follow-up Actions | `Proceed to KB-004 corpus expansion acceptance` |
