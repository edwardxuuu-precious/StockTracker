# StockTracker 当前执行 Backlog (2026-02-07)

## 1. 盘点结论 (基于代码现状)

本 backlog 不是从 `Master_Plan.md` 直接抄写,而是按当前代码实际状态整理。

- 已上线且可用: 组合 CRUD、基础持仓增删改、前端路由骨架、启动脚本。
- 部分完成: 组合删除与 Zustand 已有基础实现,但交互和一致性还未达“可交付”标准。
- 未实现: `chat/strategies/backtests` 前端仍为占位页; 后端 `chat/stock/strategy/backtest/realtime` 路由未接入主应用。
- 技术债务: 后端持仓接口在 `portfolio.py` 和 `holding.py` 存在重复定义,需统一。

---

## 2. 优先级 Backlog

### P0 (本周必须完成)

#### BL-001 组合管理收尾 (Goal#2 闭环)
- 优先级: `P0`
- 预计工时: `1.5-2.5 天`
- 范围:
  - 删除交互从 `window.confirm` 升级为可复用确认弹窗。
  - 创建/编辑表单补齐规则: 名称长度、资金格式、重复名校验、错误文案统一。
  - 列表新增搜索/筛选(最小可用版本)。
  - API 错误提示统一,避免 `alert` 分散处理。
- 验收标准:
  - 删除、创建、编辑均有稳定失败回显。
  - 表单提交前可阻断非法输入。
  - 列表能按名称搜索,并支持至少 1 个筛选维度。

#### BL-002 持仓 API 结构去重
- 优先级: `P0`
- 预计工时: `0.5 天`
- 范围:
  - 统一 `portfolio.py` 与 `holding.py` 的持仓接口定义。
  - 主路由只保留一套持仓实现并补充注释。
- 验收标准:
  - 代码中不存在两套同路径持仓接口实现。
  - `GET/POST/PUT/DELETE` 持仓相关功能回归通过。

#### BL-003 最小测试基线
- 优先级: `P0`
- 预计工时: `1 天`
- 范围:
  - 后端: 组合 CRUD + 持仓增删改的 API 测试。
  - 前端: 至少覆盖 1 个核心页面的表单校验流程。
- 验收标准:
  - 新增测试可本地一键执行。
  - 关键路径改动后可快速回归。

---

### P1 (Phase 2-3 核心增量)

#### BL-004 持仓管理 MVP (Goal#3)
- 优先级: `P1`
- 预计工时: `2-3 天`
- 范围:
  - 引入明确的交易语义(买入/卖出),不只做“直接改持仓”。
  - 补齐成本与收益计算策略(先落地加权平均,后续可扩展 FIFO)。
  - 前端补充交易录入与交易记录展示。
- 验收标准:
  - 可完成一笔买入和一笔卖出,并正确更新现金与持仓。
  - 收益字段有清晰计算口径并在 UI 展示。

#### BL-005 实时行情 MVP (Goal#4)
- 优先级: `P1`
- 预计工时: `2 天`
- 范围:
  - 封装行情 Provider (yfinance/akshare) 与降级策略。
  - 增加缓存层(按 symbol + TTL)。
  - 前端持仓页支持手动刷新报价。
- 验收标准:
  - 单只和批量报价接口可用。
  - 缓存命中与失效逻辑可观测。

---

### P2 (Phase 4+)

#### BL-006 数据分析面板 (Goal#5) ✅
- 优先级: `P2`
- 预计工时: `2-3 天`
- 范围: 收益拆解、基础图表、导出 CSV。
- 当前状态: `已完成(第一版, 2026-02-07)`

#### BL-007 策略回测骨架 (Goal#6) ✅
- 优先级: `P2`
- 预计工时: `2-4 天`
- 范围: 策略参数入参、回测任务执行、结果落库与查询。
- 当前状态: `已完成(骨架版, 2026-02-07)`

#### BL-008 AI 助手骨架 (Goal#7)
- 优先级: `P2`
- 预计工时: `2-3 天`
- 范围: 对话 API、会话持久化、前端聊天页替换占位内容。

#### BL-009 部署基线 (Goal#8)
- 优先级: `P2`
- 预计工时: `1-2 天`
- 范围: Dockerfile + docker-compose + 最小 CI。

---

## 3. 推荐执行顺序 (两周)

### 2026-02-08 ~ 2026-02-11
- 完成 `BL-001` + `BL-002`

### 2026-02-12 ~ 2026-02-14
- 完成 `BL-003` + `BL-004`(第一版)

### 2026-02-15 ~ 2026-02-18
- 完成 `BL-005`(第一版) + `BL-006`(第一版) + `BL-007`(骨架版)

---

## 4. 交付准则 (DoD)

- 功能可跑: 前后端可通过 `start-all.bat` 一键启动。
- 可验证: 至少有一条自动化测试覆盖关键路径。
- 可回退: 关键写操作失败时有明确错误反馈。
- 可维护: 路由和服务无重复实现,文档与代码一致。

---

**维护说明:**
- 本文件用于“当前执行面”排期,优先级高于历史 Todo 草稿。
- 每完成一个 BL 项,同步更新 `Master_Progress.md` 和对应 Goal 文档。
