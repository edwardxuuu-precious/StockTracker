# UAT Report: KB-004 Benchmark Corpus And Threshold Policy (2026-02-09)

## 1) Basic Info

| Field | Value |
| --- | --- |
| Project | `StockTracker` |
| Scope | `KB-004` |
| Environment | `Local (Windows)` |
| Tester | `edwar + Codex` |
| Test Date | `2026-02-09` |

## 2) Scope

- Larger project-domain benchmark corpus pack (mixed `pdf/txt/json` source types).
- New KB benchmark case set for KB-004.
- Profile-based KB benchmark threshold policy and release gate enforcement.

## 3) Commands And Results

| Case ID | Command / Step | Expected | Actual | Status | Evidence |
| --- | --- | --- | --- | --- | --- |
| `KB4-UAT-01` | `python backend/scripts/kb_benchmark.py --cases backend/config/kb_benchmark_cases.kb004.json --reset-db` | Benchmark can seed larger corpus and output summary metrics | `seeded_documents=28`, `avg_precision_at_k=0.625`, `avg_keyword_recall=1.0` | `PASS` | Console output + `.runtime/kb_benchmark.sqlite3` |
| `KB4-UAT-02` | Verify corpus pack config files | Corpus pack + case set + policy file are present | Files exist and parse successfully | `PASS` | `backend/config/kb_benchmark_corpus/corpus_pack.json`, `backend/config/kb_benchmark_cases.kb004.json`, `backend/config/kb_benchmark_policy.json` |
| `KB4-UAT-03` | `python backend/scripts/release_gate.py --profile prod --allow-dirty-git --skip-tests --skip-frontend --skip-docker` with `APP_ENV=production` and `SECRET_KEY` set | Prod gate applies policy thresholds and passes KB benchmark check | `kb-benchmark: pass`, `cases=kb_benchmark_cases.kb004.json`, thresholds `precision>=0.55`, `recall>=0.8` | `PASS` | `.runtime/release_gate_prod_20260209T104147Z.json` |
| `KB4-UAT-04` | `python -m pytest backend/tests/test_release_gate.py -q` | Release-gate policy logic tests pass | `4 passed` | `PASS` | pytest output |
| `KB4-UAT-05` | `python -m pytest backend/tests -q` | No backend regression after KB-004 integration | `53 passed` | `PASS` | pytest output |

## 4) Acceptance Decision

| Decision | Value |
| --- | --- |
| Go / No-Go | `Go` |
| Residual Risk | `Large external real-world corpora (user-provided PDFs/TXTs/JSONs) still need staged threshold recalibration over time` |
| Follow-up | `Start KB-005: continuous benchmark drift tracking and threshold tuning workflow` |
